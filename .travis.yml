language: python

python: 3.6

sudo: false

before_install:
 - pip install -r test-requirements.txt
 - flake8 -v .
 - rst-lint README.rst

script:
 - python setup.py sdist install || exit 1
 - python -c 'import idr'
 # TODO: Set IDR_USER IDR_HOST IDR_PASSWORD and run tests
 #- pytest
 - ./travis-conda-test.sh

deploy:
  provider: pypi
  user: $PYPI_USER
  password: $PYPI_PASSWORD
  on:
    tags: true
